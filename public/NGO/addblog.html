<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png" />
    <link rel="icon" type="image/png" href="../assets/img/favicon.png" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Add Bolg</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="viewport" content="width=device-width" />
    <!-- Bootstrap core CSS     -->
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet" />
    <!--  Material Dashboard CSS    -->
    <link href="../assets/css/material-dashboard.css?v=1.2.0" rel="stylesheet" />
    <!--  CSS for Demo Purpose, don't include it in your project     
    <link href="../assets/css/demo.css" rel="stylesheet" /> -->
    <!--     Fonts and icons     -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Roboto:400,700,300|Material+Icons' rel='stylesheet' type='text/css'>

<script src="../assets/js/jquery.min.js"> </script>
<script> 
$(function(){
  $("#sidebarclass").load("sidebar.html"); 
  $("#headerclass").load("header.html"); 
  $("#footerclass").load("footer.html"); 
  
});
</script> 

<script type="text/javascript">
    function allLetter(txttitle)
    {
    	var title=/^[A-Za-z]+$/;
    	if(txttitle.value.match(title))
    	{
		    return true;
	    }
	    else
	    {		
    		txttitle.value="";
		    txttitle.focus();
		    alert('Blog Title must have Alphabetic characters only');
		    return false;
	    }
    }
    function letter(txtauthor)
    {
    	var author=/^[A-Za-z]+$/;
    	if(txtauthor.value.match(author))
    	{
		    return true;
	    }
	    else
	    {		
    		txtauthor.value="";
	    	txtauthor.focus();
		    alert(' Author name must have Alphabetic characters only');
    		return false;
    	}
    }
</script>

</head>

<body>
    <div class="wrapper">
        <div id="sidebarclass">
		
		</div>
        <div class="main-panel">
            <div id="headerclass">
			
			</div>
            <div class="content" style="margin-top:30px;">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header" data-background-color="purple">
                                    <h3 class="title">Add Blog</h3>
                                    <!-- <p class="category">Add new Blog</p> -->
                                </div>
                                <div class="card-content">
                                    <form action="addblog.html" method="POST">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group label-floating">
                                                    <label class="control-label">Title</label>
                                                    <input type="text" name="txttitle" onblur="return allLetter(txttitle);" class="form-control" required/>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">                                                
                                            <div class="col-md-6">
                                                <div class="form-group label-floating">
                                                    <label class="control-label">Author</label>
                                                    <input type="text" name="txtauthor" onblur="return letter(txtauthor);" class="form-control" required/>
                                                </div>
                                            </div>                                        
                                            <div class="col-md-6">
                                                <div class="form-group label-floating">
                                                    <label class="control-label">Category</label>
                                                        <select class="form-control" name="drpcategory" style="float:left;" required>
                                                            <option value="category1">Category 1</option>											
                                                            <option value="category2">Category 2</option>
                                                            <option value="category3">Category 3</option>
                                                        </select>										
                                                    </div>
                                                </div>
                                        </div>                                                                                
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="label-floating">
                                                    <label class="control-label">Featured Image</label>
                                                    <input type="file" 
                                                    id="inputFileToLoad" 
                                                    onchange="encodeImageFileAsURL();"
                                                    name="txtfeaturedimage" required/>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="label-floating">
                                                    <label class="control-label">Image</label>
                                                    <input type="file" name="txtmultiimage"
                                                    id="inputFileToLoad2" 
                                                    onchange="encodeImageFileAsURL2();" multiple required/>
                                                </div>
                                            </div>
                                        </div>  
                                        <div class="row">

                                            <div class="label-floating col-md-12">
                                                <label class="control-label">Blog Content</label>
                                                <textarea rows="12" cols="125"></textarea>                                                
                                            <div class="col-md-12">
                                                <label class="control-label">Blog Body</label>
                                                <input type="text" name="txtbody" onblur="return letter(txtauthor);" class="form-control" required/>
                                            </div>
                                        </div>                                                                              
										<center>
                                            <input id="btnCreate" type="button" value="Post" class="btn btn-primary pull-right"></center>
                                        <div class="clearfix"></div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
            <div id="footerclass">
			
			</div>
        </div>
    </div>
</body>
<!--   Core JS Files   -->
<script src="../assets/js/jquery-3.2.1.min.js" type="text/javascript"></script>
<script src="../assets/js/bootstrap.min.js" type="text/javascript"></script>
<script src="../assets/js/material.min.js" type="text/javascript"></script>
<!--  Charts Plugin -->
<script src="../assets/js/chartist.min.js"></script>
<!--  Dynamic Elements plugin -->
<script src="../assets/js/arrive.min.js"></script>
<!--  PerfectScrollbar Library -->
<script src="../assets/js/perfect-scrollbar.jquery.min.js"></script>
<!--  Notifications Plugin    -->
<script src="../assets/js/bootstrap-notify.js"></script>
<!--  Google Maps Plugin    -->
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script>
<!-- Material Dashboard javascript methods -->
<script src="../assets/js/material-dashboard.js?v=1.2.0"></script>
<!-- Material Dashboard DEMO methods, don't include it in your project! -->
<script src="../assets/js/demo.js"></script>


<script src="../assets/js/bootstrap-datepicker.js" type="text/javascript"></script>
<script src="../assets/js/material-kit.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js" type="text/javascript"></script>

<script>
  var photoUrl = "";
  var photoUrl2="";
  function encodeImageFileAsURL() {

    var filesSelected = document.getElementById("inputFileToLoad").files;
    if (filesSelected.length > 0) {
      var fileToLoad = filesSelected[0];

      var fileReader = new FileReader();

      fileReader.onload = function(fileLoadedEvent) {
        var srcData = fileLoadedEvent.target.result; // <--- data: base64
        photoUrl = srcData;
      }
      fileReader.readAsDataURL(fileToLoad);
    }
  }

  function encodeImageFileAsURL2() {

    var filesSelected = document.getElementById("inputFileToLoad2").files;
    if (filesSelected.length > 0) {
      var fileToLoad = filesSelected[0];

      var fileReader = new FileReader();

      fileReader.onload = function(fileLoadedEvent) {
        var srcData = fileLoadedEvent.target.result; // <--- data: base64
        photoUrl2 = srcData;
      }
      fileReader.readAsDataURL(fileToLoad);
    }
  }
    /*function validate(eventData)
    {
        
        if(eventData.name=="")
        {
            alert("Event Name is not found");
            return false;
        }
        if(eventData.totalDays=="")
        {
            alert("Event Total Days is not found");
            return false;
        }
        if(eventData.volunteerSize=="")
        {
            alert("Volunteer Size is not found");
            return false;
        }
        if(eventData.date=="")
        {
            alert("Event Date is not found");
            return false;
        }
        if(eventData.venue.street=="")
        {
            alert("Event Street is not found");
            return false;
        }
        
        return true;
    }*/
  $().ready(function(){
      var ngoId = "5ab7a12117f80f169302a9bc";
      $("#btnCreate").click(function(event){
        event.preventDefault();
        console.log('btnsubmit');
        var eventData ={
            title: $("input[name=txttitle]").val(),
            author: $("input[name=txttitle]").val(),
            type: $('select[name=drpeventtype]').val(),
            images: [
              {image: photoUrl2}
            ],
            featuresImage: photoUrl,
            body: $("input[name=txtbody]").val()

        }
        console.log(eventData);
        /*if (validate(eventData)==false)
            return;*/

        axios.post('/api/blog/'+ngoId, eventData)
             .then(function (resp) {
                alert('blog added');
                console.log(resp);
                window.location.reload(false); 
             })
             .catch(function (error) {
                console.log(error.data);
                alert('error creating blog.')
             }
        );

      });      
  });
  

</script>

</html>